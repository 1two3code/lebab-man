{"version":3,"sources":["pacman/TitleState.ts"],"names":["pacman","pacman.TitleState","pacman.TitleState.constructor","pacman.TitleState.init","pacman.TitleState.leaving","pacman.TitleState.handleStart","pacman.TitleState.update","pacman.TitleState.render","pacman.TitleState._stringWidth","pacman.TitleState._renderNoSoundMessage","pacman.TitleState._renderStaticStuff","pacman.TitleState._startGame","pacman.TitleState.getGame"],"mappings":"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","file":"pacman/TitleState.js","sourcesContent":["module pacman {\r\n  'use strict';\r\n\r\n  export class TitleState extends _BaseState {\r\n\r\n    private _delay: gtp.Delay;\r\n    private _blink: boolean;\r\n    private _choice: number;\r\n\r\n    /**\r\n\t\t * State that renders the title screen.\r\n\t\t * @constructor\r\n\t\t */\r\n      constructor(args?: pacman.PacmanGame | gtp.BaseStateArgs) {\r\n        super(args);\r\n      }\r\n\r\n      init() {\r\n        super.init();\r\n        game.canvas.addEventListener('touchstart', this.handleStart, false);\r\n        this._delay = new gtp.Delay({ millis: [ 600, 400 ] });\r\n        this._blink = true;\r\n        this._choice = 0;\r\n      }\r\n\r\n      leaving(game: gtp.Game) {\r\n        game.canvas.removeEventListener('touchstart', this.handleStart, false);\r\n      }\r\n\r\n      handleStart() {\r\n        console.log('Yee, touch detected!');\r\n        this._startGame();\r\n      }\r\n\r\n      update(delta: number) {\r\n\r\n        this.handleDefaultKeys();\r\n\r\n        if (this._delay.update(delta)) {\r\n           this._delay.reset();\r\n           this._blink = !this._blink;\r\n        }\r\n\r\n        var im = game.inputManager;\r\n        if (im.up(true)) {\r\n           this._choice = Math.abs(this._choice - 1);\r\n           game.audio.playSound(pacman.Sounds.TOKEN);\r\n        }\r\n        else if (im.down(true)) {\r\n           this._choice = (this._choice + 1) % 2;\r\n           game.audio.playSound(pacman.Sounds.TOKEN);\r\n        }\r\n        else if (im.enter(true)) {\r\n           this._startGame();\r\n        }\r\n\r\n      }\r\n\r\n      render(ctx: CanvasRenderingContext2D) {\r\n\r\n        var SCREEN_WIDTH = game.getWidth(),\r\n            SCREEN_HEIGHT = game.getHeight(),\r\n            charWidth = 9;\r\n\r\n        this._renderStaticStuff(ctx);\r\n\r\n        // Draw the menu \"choice\" arrow\r\n        // \" - 5\" to account for differently sized choices\r\n        var x = (SCREEN_WIDTH - charWidth * 15) / 2 - 5;\r\n        var y = (SCREEN_HEIGHT - 15 * 2) / 2;\r\n        this.getGame().drawString(x, y + this._choice * 15, '>');\r\n\r\n        // Draw the small and big dots\r\n        x += charWidth * 1.5;\r\n        y = 200;\r\n        game.canvas.getContext('2d').fillStyle = '#ffffff';\r\n        game.drawSmallDot(x + 3, y + 2);\r\n        y += 9;\r\n        game.drawBigDot(x, y);\r\n\r\n        if (!game.audio.isInitialized()) {\r\n           this._renderNoSoundMessage();\r\n        }\r\n      }\r\n\r\n      _stringWidth(str: string): number {\r\n        return game.assets.get('font').cellW * str.length;\r\n      }\r\n\r\n      _renderNoSoundMessage() {\r\n\r\n        var w = game.getWidth();\r\n\r\n        var text = 'SOUND IS DISABLED AS';\r\n        var x = (w - this._stringWidth(text)) / 2;\r\n        var y = game.getHeight() - 20 - 9*3;\r\n        this.getGame().drawString(x, y, text);\r\n        text = 'YOUR BROWSER DOES NOT';\r\n        x = ( w - this._stringWidth(text)) / 2;\r\n        y += 9;\r\n        this.getGame().drawString(x, y, text);\r\n        text = 'SUPPORT WEB AUDIO';\r\n        x = (w - this._stringWidth(text)) / 2;\r\n        y += 9;\r\n        this.getGame().drawString(x, y, text);\r\n      }\r\n\r\n      // TODO: Move this stuff into an image that gets rendered each frame?\r\n      _renderStaticStuff(ctx: CanvasRenderingContext2D) {\r\n\r\n        var game = this.game;\r\n        game.clearScreen('rgb(0,0,0)');\r\n        var SCREEN_WIDTH = game.getWidth();\r\n        var charWidth = 9;\r\n\r\n        // Title image\r\n        var titleImage = game.assets.get('title');\r\n        var x = (SCREEN_WIDTH - titleImage.width) / 2;\r\n        var y = titleImage.height * 1.2;\r\n        titleImage.draw(ctx, x, y);\r\n\r\n        // Game menu\r\n        var temp = 'STANDARD MAZE';\r\n        var charCount = temp.length - 1; // \"-1\" for selection arrow\r\n        // \" - 5\" to account for differently sized choices\r\n        x = (SCREEN_WIDTH - charWidth * charCount) / 2 - 5;\r\n        y = (game.getHeight() - 15 * 2) / 2;\r\n        this.getGame().drawString(x, y, temp, ctx);\r\n        temp = 'ALTERNATE MAZE';\r\n        y += 15;\r\n        this.getGame().drawString(x, y, temp, ctx);\r\n\r\n        // Scores for the dot types\r\n        x += charWidth * 2;\r\n        temp = '10 POINTS';\r\n        charCount = temp.length - 2; // \"-2\" for animated dots\r\n        y = 200;\r\n        this.getGame().drawString(x, y, temp, ctx);\r\n        temp = '50 POINTS';\r\n        y += 9;\r\n        this.getGame().drawString(x, y, temp, ctx);\r\n\r\n        // Copyright\r\n        temp = '2015 OLD MAN GAMES';\r\n        x = (SCREEN_WIDTH - charWidth * temp.length) / 2;\r\n        y = game.getHeight() - 20;\r\n        this.getGame().drawString(x, y, temp, ctx);\r\n      }\r\n\r\n      _startGame() {\r\n        game.startGame(this._choice);\r\n      }\r\n\r\n      private getGame(): PacmanGame {\r\n        return <PacmanGame>this.game;\r\n      }\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}