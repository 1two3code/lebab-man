{"version":3,"sources":["pacman/MazeState.ts"],"names":["pacman","pacman.MazeState","pacman.MazeState.constructor","pacman.MazeState.init","pacman.MazeState._paintExtraLives","pacman.MazeState._paintPossibleFruits","pacman.MazeState.render","pacman.MazeState.update"],"mappings":";;;;;AAAA,IAAO,MAAM,CA4HZ;AA5HD,WAAO,QAAM,EAAC,CAAC;IACbA,YAAYA,CAACA;IAEbA;QAA+BC,6BAAUA;QAQvCA,mBAAYA,QAAgBA;YAC1BC,iBAAOA,CAACA;YACRA,IAAIA,CAACA,SAASA,GAAGA,QAAQA,CAACA;QAC5BA,CAACA;QAEDD,wBAAIA,GAAJA;YAEEE,IAAIA,CAACA,MAAMA,CAACA,KAAKA,EAAEA,CAACA;YACpBA,qBAAqBA;YAErBA,IAAIA,CAACA,KAAKA,GAAGA,IAAIA,aAAIA,CAACA,IAAIA,CAACA,SAASA,CAACA,CAACA;YACtCA,IAAIA,CAACA,iBAAiBA,GAAGA,IAAIA,CAACA;YAC9BA,IAAIA,CAACA,iBAAiBA,GAAGA,CAACA,CAACA,CAACA;QAC9BA,CAACA;QAEDF,oCAAgBA,GAAhBA,UAAiBA,GAA6BA;YAE5CG,mEAAmEA;YACnEA,6CAA6CA;YAC7CA,IAAIA,aAAaA,GAAGA,EAAEA,CAACA;YACvBA,IAAIA,SAASA,GAAGA,CAACA,CAACA;YAElBA,IAAIA,KAAKA,GAAGA,IAAIA,CAACA,KAAKA,CAACA;YACvBA,EAAEA,CAACA,CAACA,KAAKA,GAAGA,CAACA,CAACA,CAACA,CAACA;gBACbA,IAAIA,CAACA,GAAGA,aAAaA,CAACA;gBACtBA,IAAIA,CAACA,GAAGA,IAAIA,CAACA,SAASA,EAAEA,GAAGA,CAACA,GAAGA,SAASA,CAACA;gBACzCA,IAAIA,CAACA,GAAGA,CAACA,GAAGA,SAASA,CAACA;gBACtBA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,KAAKA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;oBAC9BA,IAAIA,CAACA,UAAUA,CAACA,CAACA,EAAEA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAAEA,CAACA,GAACA,EAAEA,CAACA,CAACA;oBACnCA,CAACA,IAAIA,CAACA,CAACA;gBACVA,CAACA;YACJA,CAACA;QACLA,CAACA;QAECH,wCAAoBA,GAApBA,UAAqBA,GAA6BA;YAEhDI,mEAAmEA;YACnEA,6CAA6CA;YAC7CA,IAAIA,aAAaA,GAAGA,EAAEA,CAACA;YACvBA,IAAIA,SAASA,GAAGA,CAACA,CAACA;YAElBA,IAAIA,CAACA,GAAGA,IAAIA,CAACA,QAAQA,EAAEA,GAAGA,aAAaA,GAAGA,CAACA,GAAGA,SAASA,CAACA;YACxDA,IAAIA,CAACA,GAAGA,IAAIA,CAACA,SAASA,EAAEA,GAAGA,CAACA,GAAGA,SAASA,CAACA;YAEzCA,MAAMA,CAACA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA;gBAClBA,QAAQA;gBACRA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,GAACA,GAAGA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;gBACrCA,eAAeA;gBAClBA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,GAACA,EAAEA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;gBACpCA,eAAeA;gBAClBA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,GAACA,GAAGA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;gBACrCA,gBAAgBA;gBACnBA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,GAACA,GAAGA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;gBACrCA,gBAAgBA;gBACnBA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,GAACA,EAAEA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;gBACpCA,gBAAgBA;gBACnBA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,GAACA,EAAEA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;gBACpCA,gBAAgBA;gBACnBA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,GAACA,EAAEA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;gBACpCA,gBAAgBA;gBACnBA,KAAKA,CAACA;oBACHA,IAAIA,CAACA,UAAUA,CAACA,CAACA,EAACA,CAACA,EAAEA,EAAEA,GAACA,EAAEA,EAACA,CAACA,GAACA,EAAEA,CAACA,CAACA;oBACjCA,KAAKA,CAACA;YACZA,CAACA;QACHA,CAACA;QAEDJ,0BAAMA,GAANA,UAAOA,GAA6BA;YAElCK,gBAAKA,CAACA,MAAMA,YAACA,GAAGA,CAACA,CAACA;YAClBA,IAAIA,CAACA,KAAKA,CAACA,MAAMA,CAACA,GAAGA,CAACA,CAACA;YAEvBA,0DAA0DA;YAC1DA,IAAIA,SAASA,GAAGA,CAACA,CAACA;YAClBA,IAAIA,KAAKA,GAAGA,IAAIA,CAACA,SAASA,EAAEA,GAAGA,CAACA,GAACA,SAASA;gBACpCA,aAAIA,CAACA,mBAAmBA,GAAGA,SAASA,CAACA;YAC3CA,GAAGA,CAACA,SAASA,CAACA,CAACA,EAAEA,KAAKA,CAACA,CAACA;YAExBA,uBAAuBA;YAEvBA,IAAIA,MAAMA,GAAGA,IAAIA,CAACA,MAAMA,CAACA;YACzBA,EAAEA,CAACA,CAACA,IAAIA,CAACA,iBAAiBA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;gBACjCA,EAAEA,CAACA,CAACA,IAAIA,CAACA,SAASA,KAAKA,CAACA,CAAAA,sBAAsBA,CAACA,CAACA,CAACA;oBAC9CA,MAAMA,CAACA,MAAMA,CAACA,GAAGA,CAACA,CAACA;gBACtBA,CAACA;YACJA,CAACA;YACDA,IAAIA,CAACA,CAACA;gBACHA,IAAIA,CAACA,GAAGA,MAAMA,CAACA,MAAMA,CAACA,CAACA,CAACA;gBACxBA,IAAIA,CAACA,GAAGA,MAAMA,CAACA,MAAMA,CAACA,CAACA,CAACA;gBACxBA,IAAIA,CAACA,iBAAiBA,CAACA,GAAGA,EAAEA,IAAIA,CAACA,iBAAiBA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;YAC7DA,CAACA;YAEDA,wBAAwBA;YAExBA,GAAGA,CAACA,SAASA,CAACA,CAACA,EAAEA,CAACA,KAAKA,CAACA,CAACA;YAEzBA,IAAIA,CAACA,UAAUA,CAACA,GAAGA,CAACA,CAACA;YACrBA,IAAIA,CAACA,gBAAgBA,CAACA,GAAGA,CAACA,CAACA;YAC3BA,IAAIA,CAACA,oBAAoBA,CAACA,GAAGA,CAACA,CAACA;YAE/BA,gEAAgEA;QAClEA,CAACA;QAEDL,0BAAMA,GAANA,UAAOA,KAAaA;YAClBM,gBAAKA,CAACA,MAAMA,YAACA,KAAKA,CAACA,CAACA;QACtBA,CAACA;QACHN,gBAACA;IAADA,CAxHAD,AAwHCC,EAxH8BD,mBAAUA,EAwHxCA;IAxHYA,kBAASA,YAwHrBA,CAAAA;AACHA,CAACA,EA5HM,MAAM,KAAN,MAAM,QA4HZ","file":"pacman/MazeState.js","sourcesContent":["module pacman {\r\n  'use strict';\r\n\r\n  export class MazeState extends _BaseState {\r\n\r\n    private _mazeFile: string;\r\n    private _maze: Maze;\r\n    private _firstTimeThrough: boolean;\r\n    private _updateScoreIndex: number;\r\n    private _substate: number;\r\n\r\n    constructor(mazeFile: string) {\r\n      super();\r\n      this._mazeFile = mazeFile;\r\n    }\r\n\r\n    init() {\r\n\r\n      game.pacman.reset();\r\n      //game.resetGhosts();\r\n\r\n      this._maze = new Maze(this._mazeFile);\r\n      this._firstTimeThrough = true;\r\n      this._updateScoreIndex = -1;\r\n    }\r\n\r\n    _paintExtraLives(ctx: CanvasRenderingContext2D) {\r\n\r\n      // The indentation on either side of the status stuff at the bottom\r\n      // (extra life count, possible fruits, etc.).\r\n      var BOTTOM_INDENT = 24;\r\n      var TILE_SIZE = 8;\r\n\r\n      var lives = game.lives;\r\n      if (lives > 0) {\r\n         var x = BOTTOM_INDENT;\r\n         var y = game.getHeight() - 2 * TILE_SIZE;\r\n         var w = 2 * TILE_SIZE;\r\n         for (var i = 0; i < lives; i++) {\r\n            game.drawSprite(x, y, 12*16, 3*16);\r\n            x += w;\r\n         }\r\n      }\r\n  }\r\n\r\n    _paintPossibleFruits(ctx: CanvasRenderingContext2D) {\r\n\r\n      // The indentation on either side of the status stuff at the bottom\r\n      // (extra life count, possible fruits, etc.).\r\n      var BOTTOM_INDENT = 24;\r\n      var TILE_SIZE = 8;\r\n\r\n      var x = game.getWidth() - BOTTOM_INDENT - 2 * TILE_SIZE;\r\n      var y = game.getHeight() - 2 * TILE_SIZE;\r\n\r\n      switch (game.level) {\r\n         default:\r\n         case 7: // Key\r\n            game.drawSprite(x-112,y, 13*16,3*16);\r\n            // Fall through\r\n         case 6: // Space Invaders ship\r\n            game.drawSprite(x-96,y, 13*16,6*16);\r\n            // Fall through\r\n         case 5: // Green thing (grapes?)\r\n            game.drawSprite(x-160,y, 12*16,6*16);\r\n            // Fall through.\r\n         case 4: // Apple\r\n            game.drawSprite(x-128,y, 13*16,2*16);\r\n            // Fall through.\r\n         case 3: // Yellow bell\r\n            game.drawSprite(x-96,y, 13*16,5*16);\r\n            // Fall through.\r\n         case 2: // Peach\r\n            game.drawSprite(x-64,y, 12*16,5*16);\r\n            // Fall through.\r\n         case 1: // Strawberry\r\n            game.drawSprite(x-32,y, 13*16,4*16);\r\n            // Fall through.\r\n         case 0: // Cherry\r\n            game.drawSprite(x,y, 12*16,4*16);\r\n            break;\r\n      }\r\n    }\r\n\r\n    render(ctx: CanvasRenderingContext2D) {\r\n\r\n      super.render(ctx);\r\n      this._maze.render(ctx);\r\n\r\n      // \"window.pacman\" because of hoisting of pacman var below\r\n      var TILE_SIZE = 8;\r\n      var mazeY = game.getHeight() - 2*TILE_SIZE -\r\n            Maze.TILE_COUNT_VERTICAL * TILE_SIZE;\r\n      ctx.translate(0, mazeY);\r\n\r\n      //game.paintFruit(ctx);\r\n\r\n      var pacman = game.pacman;\r\n      if (this._updateScoreIndex === -1) {\r\n         if (this._substate !== 0/*SUBSTATE_GAME_OVER*/) {\r\n            pacman.render(ctx);\r\n         }\r\n      }\r\n      else {\r\n         var x = pacman.bounds.x;\r\n         var y = pacman.bounds.y;\r\n         game.paintPointsEarned(ctx, this._updateScoreIndex, x, y);\r\n      }\r\n\r\n      //game.paintGhosts(ctx);\r\n\r\n      ctx.translate(0, -mazeY);\r\n\r\n      game.drawScores(ctx);\r\n      this._paintExtraLives(ctx);\r\n      this._paintPossibleFruits(ctx);\r\n\r\n      // TODO: Subtate messages - \"READY\", \"GAME OVER\", \"PAUSED\", etc.\r\n    }\r\n\r\n    update(delta: number) {\r\n      super.update(delta);\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}